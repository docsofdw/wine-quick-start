---
import { Image } from 'astro:assets';
import BaseLayout from '../layouts/BaseLayout.astro';
import WinePairingsIcon from '../components/icons/WinePairingsIcon.astro';
import LearnWineIcon from '../components/icons/LearnWineIcon.astro';
import SmartBuyingIcon from '../components/icons/SmartBuyingIcon.astro';
import TrustSignals from '../components/sections/TrustSignals.astro';
import FeaturedShowcase from '../components/sections/FeaturedShowcase.astro';

import homepageHero from '../assets/images/hero/homepage-hero.png';

const featuredPairings = [
  {
    title: "Best Wine with Salmon",
    slug: "best-wine-with-salmon",
    description: "Light whites like Albari√±o or delicate Pinot Noir perfectly complement salmon's rich oils.",
    readTime: "5 min"
  },
  {
    title: "Pinot Noir Food Pairing",
    slug: "pinot-noir-food-pairing",
    description: "The versatile red that pairs beautifully with everything from duck to mushrooms.",
    readTime: "7 min"
  },
  {
    title: "Wine for Mushroom Risotto",
    slug: "wine-pairing-mushroom-risotto",
    description: "Earthy Nebbiolo or aged Chardonnay enhance risotto's creamy umami flavors.",
    readTime: "4 min"
  },
  {
    title: "Bordeaux Wine Guide",
    slug: "bordeaux-wine-guide",
    description: "Master the world's most prestigious wine region with our complete guide.",
    readTime: "12 min"
  }
];

// Structured data for SEO
const schema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Wine Quick Start",
  "description": "Expert wine guidance from certified sommeliers. Find the right wine for any occasion.",
  "url": "https://winesquickstart.com"
};
---

<BaseLayout
  title="Wine Quick Start - Expert Wine Guidance"
  description="Expert wine guidance from certified sommeliers. Find the right wine for any occasion."
  schema={schema}
>
  <!-- Hero with Background Image -->
  <section class="relative min-h-[70vh] flex items-center overflow-hidden">
    <!-- Background Image -->
    <div class="absolute inset-0 z-0">
      <Image
        src={homepageHero}
        alt="Atmospheric wine cellar background"
        class="w-full h-full object-cover"
        widths={[800, 1200, 1920, 2560]}
        sizes="100vw"
      />
      <div class="absolute inset-0 bg-gradient-to-r from-wine-900/90 via-wine-900/70 to-wine-900/50"></div>
    </div>

    <!-- Hero Content -->
    <div class="container relative z-10 py-20">
      <div class="max-w-2xl">
        <h1 class="font-serif text-5xl md:text-6xl lg:text-7xl font-bold text-white mb-6 leading-tight">
          Perfect Wine, Every Time
        </h1>
        <p class="text-xl md:text-2xl text-wine-100 mb-10 leading-relaxed">
          Expert wine guidance from certified sommeliers. Find the right wine for any occasion.
        </p>
        <div class="flex flex-col sm:flex-row gap-4">
          <a href="/wine-pairings/" class="btn-primary btn-press">
            Explore Wine Pairings
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
          <a href="/learn/" class="btn-secondary bg-white/10 border-white/30 text-white hover:bg-white/20">
            Start Learning
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Trust Signals -->
  <TrustSignals />

  <!-- Main Categories -->
  <section class="section-padding">
    <div class="container">
      <h2 class="text-4xl font-bold text-center mb-4 text-gray-900">Everything You Need</h2>
      <p class="text-xl text-center text-gray-600 mb-12 max-w-2xl mx-auto">
        Whether you're pairing, learning, or buying - we've got you covered
      </p>

      <div class="wine-grid wine-grid-3 stagger-children">
        <div class="wine-card group">
          <div class="w-14 h-14 bg-wine-50 rounded-xl flex items-center justify-center mb-6 group-hover:bg-wine-100 transition-colors">
            <WinePairingsIcon class="w-8 h-8 text-wine-600" />
          </div>
          <h3 class="text-2xl font-semibold mb-3 text-gray-900">Wine Pairings</h3>
          <p class="text-gray-600 mb-6 flex-grow">Perfect wine matches for your favorite dishes, from salmon to steak.</p>
          <a href="/wine-pairings/" class="text-wine-600 font-medium hover:text-wine-700 transition link-underline inline-block">
            Browse Pairings
          </a>
        </div>

        <div class="wine-card group">
          <div class="w-14 h-14 bg-wine-50 rounded-xl flex items-center justify-center mb-6 group-hover:bg-wine-100 transition-colors">
            <LearnWineIcon class="w-8 h-8 text-wine-600" />
          </div>
          <h3 class="text-2xl font-semibold mb-3 text-gray-900">Learn Wine</h3>
          <p class="text-gray-600 mb-6 flex-grow">Simple guides to understanding wine regions, varieties, and tasting.</p>
          <a href="/learn/" class="text-wine-600 font-medium hover:text-wine-700 transition link-underline inline-block">
            Start Learning
          </a>
        </div>

        <div class="wine-card group">
          <div class="w-14 h-14 bg-wine-50 rounded-xl flex items-center justify-center mb-6 group-hover:bg-wine-100 transition-colors">
            <SmartBuyingIcon class="w-8 h-8 text-wine-600" />
          </div>
          <h3 class="text-2xl font-semibold mb-3 text-gray-900">Shop Wine</h3>
          <p class="text-gray-600 mb-6 flex-grow">Sommelier-curated wines at every price point, plus gifts and subscriptions.</p>
          <a href="/shop/" class="text-wine-600 font-medium hover:text-wine-700 transition link-underline inline-block">
            Browse Wines
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Showcase Section -->
  <FeaturedShowcase />

  <!-- Services Promo -->
  <section class="section-padding bg-wine-50">
    <div class="container">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Advisory Promo -->
        <a href="/subscription/" class="group relative bg-gradient-to-br from-wine-900 via-wine-800 to-wine-900 rounded-2xl p-8 lg:p-10 text-white overflow-hidden hover:shadow-xl transition-shadow">
          <div class="absolute inset-0 opacity-20">
            <div class="absolute top-0 right-0 w-64 h-64 bg-wine-500 rounded-full blur-3xl"></div>
          </div>
          <div class="relative z-10">
            <span class="text-wine-300 text-sm font-medium tracking-wider uppercase">Wine Advisory</span>
            <h3 class="font-serif text-3xl font-bold mt-2 mb-3 group-hover:text-wine-200 transition">Your Personal Sommelier</h3>
            <p class="text-wine-100 mb-6">Ongoing expert guidance for every wine decision. Like having a sommelier friend on speed dial.</p>
            <span class="inline-flex items-center gap-2 text-white font-medium group-hover:gap-3 transition-all">
              Learn More
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </span>
          </div>
        </a>

        <!-- Gift Consulting Promo -->
        <a href="/gifts/" class="group relative bg-white rounded-2xl p-8 lg:p-10 border border-gray-200 overflow-hidden hover:border-wine-200 hover:shadow-xl transition-all">
          <div class="absolute top-4 right-4 text-5xl opacity-20 group-hover:opacity-30 transition">üéÅ</div>
          <div class="relative z-10">
            <span class="text-wine-600 text-sm font-medium tracking-wider uppercase">Gift Consulting</span>
            <h3 class="font-serif text-3xl font-bold text-gray-900 mt-2 mb-3 group-hover:text-wine-700 transition">Give Something They'll Love</h3>
            <p class="text-gray-600 mb-6">Stop guessing. Get expert help picking the perfect wine gift for any occasion.</p>
            <span class="inline-flex items-center gap-2 text-wine-600 font-medium group-hover:gap-3 transition-all">
              Get Recommendations
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </span>
          </div>
        </a>
      </div>
    </div>
  </section>

  <!-- Featured Articles -->
  <section class="section-padding">
    <div class="container">
      <h2 class="font-serif text-4xl font-bold text-center mb-4 text-gray-900">Popular Guides</h2>
      <p class="text-xl text-center text-gray-600 mb-12 max-w-2xl mx-auto">
        Our most-read articles to help you on your wine journey
      </p>

      <div class="wine-grid wine-grid-4 stagger-children">
        {featuredPairings.map((article) => (
          <article class="wine-card group">
            <div class="flex justify-between items-center mb-3">
              <span class="text-sm text-wine-600 font-medium">{article.readTime}</span>
            </div>
            <h3 class="text-lg font-semibold mb-2 text-gray-900">
              <a href={`/wine-pairings/${article.slug}/`} class="group-hover:text-wine-600 transition">
                {article.title}
              </a>
            </h3>
            <p class="text-gray-600 text-sm leading-relaxed flex-grow">{article.description}</p>
            <a href={`/wine-pairings/${article.slug}/`} class="mt-4 text-wine-600 text-sm font-medium link-underline inline-block">
              Read Guide
            </a>
          </article>
        ))}
      </div>
    </div>
  </section>

  <!-- Newsletter -->
  <section class="section-padding bg-gray-900 text-white" id="newsletter">
    <div class="container">
      <div class="max-w-2xl mx-auto text-center">
        <h2 class="font-serif text-4xl font-bold mb-4">Get Weekly Wine Tips</h2>
        <p class="text-xl mb-8 text-gray-300">Join 5,000+ wine lovers getting expert tips every Friday</p>
        <form class="newsletter-form" id="newsletter-form">
          <input
            type="email"
            placeholder="your@email.com"
            required
            class="newsletter-input"
          />
          <button
            type="submit"
            class="newsletter-button"
          >
            Subscribe
          </button>
        </form>
        <p class="text-sm text-gray-500 mt-4">No spam, unsubscribe anytime. Expert tips every Friday.</p>
      </div>
    </div>
  </section>

  <script>
    // Newsletter form
    const form = document.getElementById('newsletter-form');
    const emailInput = form?.querySelector('input[type="email"]') as HTMLInputElement;
    const submitButton = form?.querySelector('button[type="submit"]') as HTMLButtonElement;

    form?.addEventListener('submit', async (e) => {
      e.preventDefault();

      if (!emailInput?.value) return;

      // Disable form during submission
      submitButton.disabled = true;
      submitButton.textContent = 'Subscribing...';

      try {
        const response = await fetch('/api/newsletter', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ email: emailInput.value })
        });

        const result = await response.json();

        if (result.success) {
          if (result.alreadySubscribed) {
            alert('You\'re already on our list! Check your inbox for our latest wine tips.');
          } else {
            alert('Welcome to Wine Quick Start! Check your email for confirmation.');
          }
          emailInput.value = '';
        } else {
          alert('Error: ' + (result.error || 'Something went wrong. Please try again.'));
        }
      } catch (error) {
        console.error('Newsletter signup error:', error);
        alert('Network error. Please check your connection and try again.');
      } finally {
        submitButton.disabled = false;
        submitButton.textContent = 'Subscribe';
      }
    });
  </script>
</BaseLayout>
